/* Rijndael (AES) Encryption
 * Copyright 2005 Herbert Hanewinkel, www.haneWIN.de
 * version 1.1, check www.haneWIN.de for the latest version

 * This software is provided as-is, without express or implied warranty.  
 * Permission to use, copy, modify, distribute or sell this software, with or
 * without fee, for any purpose and by any individual or organization, is hereby
 * granted, provided that the above copyright notice and this paragraph appear 
 * in all copies. Distribution as a part of an application or binary must
 * include the above copyright notice in the documentation and/or other
 * materials provided with the application or distribution.
 */"use strict";function B0(e){return e&255}function B1(e){return e>>8&255}function B2(e){return e>>16&255}function B3(e){return e>>24&255}function F1(e,t,n,r){return B1(T1[e&255])|B1(T1[t>>8&255])<<8|B1(T1[n>>16&255])<<16|B1(T1[r>>>24])<<24}function packBytes(e){var t,n,r=e.length,i=new Array(r/4);if(!e||r%4)return;for(t=0,n=0;n<r;n+=4)i[t++]=e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24;return i}function unpackBytes(e){var t,n=0,r=e.length,i=new Array(r*4);for(t=0;t<r;t++)i[n++]=B0(e[t]),i[n++]=B1(e[t]),i[n++]=B2(e[t]),i[n++]=B3(e[t]);return i}function keyExpansion(e){var t,n,r,i,s,o,u=new Array(maxrk+1),a=e.length,f=new Array(maxkc),l=new Array(maxkc),c=0;if(a==16)o=10,t=4;else if(a==24)o=12,t=6;else{if(a!=32){alert("Invalid AES key length "+a);return}o=14,t=8}for(n=0;n<maxrk+1;n++)u[n]=new Array(4);for(n=0,r=0;r<a;r++,n+=4)f[r]=e.charCodeAt(n)|e.charCodeAt(n+1)<<8|e.charCodeAt(n+2)<<16|e.charCodeAt(n+3)<<24;for(r=t-1;r>=0;r--)l[r]=f[r];i=0,s=0;for(r=0;r<t&&i<o+1;){for(;r<t&&s<4;r++,s++)u[i][s]=l[r];s==4&&(i++,s=0)}while(i<o+1){var h=l[t-1];l[0]^=S[B1(h)]|S[B2(h)]<<8|S[B3(h)]<<16|S[B0(h)]<<24,l[0]^=Rcon[c++];if(t!=8)for(r=1;r<t;r++)l[r]^=l[r-1];else{for(r=1;r<t/2;r++)l[r]^=l[r-1];h=l[t/2-1],l[t/2]^=S[B0(h)]|S[B1(h)]<<8|S[B2(h)]<<16|S[B3(h)]<<24;for(r=t/2+1;r<t;r++)l[r]^=l[r-1]}for(r=0;r<t&&i<o+1;){for(;r<t&&s<4;r++,s++)u[i][s]=l[r];s==4&&(i++,s=0)}}var p={};return p.rounds=o,p.rk=u,p}function AESencrypt(e,t){var n,r,i,s,o,u=packBytes(e),a=t.rounds,f=u[0],l=u[1],c=u[2],h=u[3];for(n=0;n<a-1;n++)r=f^t.rk[n][0],i=l^t.rk[n][1],s=c^t.rk[n][2],o=h^t.rk[n][3],f=T1[r&255]^T2[i>>8&255]^T3[s>>16&255]^T4[o>>>24],l=T1[i&255]^T2[s>>8&255]^T3[o>>16&255]^T4[r>>>24],c=T1[s&255]^T2[o>>8&255]^T3[r>>16&255]^T4[i>>>24],h=T1[o&255]^T2[r>>8&255]^T3[i>>16&255]^T4[s>>>24];return n=a-1,r=f^t.rk[n][0],i=l^t.rk[n][1],s=c^t.rk[n][2],o=h^t.rk[n][3],u[0]=F1(r,i,s,o)^t.rk[a][0],u[1]=F1(i,s,o,r)^t.rk[a][1],u[2]=F1(s,o,r,i)^t.rk[a][2],u[3]=F1(o,r,i,s)^t.rk[a][3],unpackBytes(u)}var Rcon=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],S=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],T1=[2774754246,2222750968,2574743534,2373680118,234025727,3177933782,2976870366,1422247313,1345335392,50397442,2842126286,2099981142,436141799,1658312629,3870010189,2591454956,1170918031,2642575903,1086966153,2273148410,368769775,3948501426,3376891790,200339707,3970805057,1742001331,4255294047,3937382213,3214711843,4154762323,2524082916,1539358875,3266819957,486407649,2928907069,1780885068,1513502316,1094664062,49805301,1338821763,1546925160,4104496465,887481809,150073849,2473685474,1943591083,1395732834,1058346282,201589768,1388824469,1696801606,1589887901,672667696,2711000631,251987210,3046808111,151455502,907153956,2608889883,1038279391,652995533,1764173646,3451040383,2675275242,453576978,2659418909,1949051992,773462580,756751158,2993581788,3998898868,4221608027,4132590244,1295727478,1641469623,3467883389,2066295122,1055122397,1898917726,2542044179,4115878822,1758581177,0,753790401,1612718144,536673507,3367088505,3982187446,3194645204,1187761037,3653156455,1262041458,3729410708,3561770136,3898103984,1255133061,1808847035,720367557,3853167183,385612781,3309519750,3612167578,1429418854,2491778321,3477423498,284817897,100794884,2172616702,4031795360,1144798328,3131023141,3819481163,4082192802,4272137053,3225436288,2324664069,2912064063,3164445985,1211644016,83228145,3753688163,3249976951,1977277103,1663115586,806359072,452984805,250868733,1842533055,1288555905,336333848,890442534,804056259,3781124030,2727843637,3427026056,957814574,1472513171,4071073621,2189328124,1195195770,2892260552,3881655738,723065138,2507371494,2690670784,2558624025,3511635870,2145180835,1713513028,2116692564,2878378043,2206763019,3393603212,703524551,3552098411,1007948840,2044649127,3797835452,487262998,1994120109,1004593371,1446130276,1312438900,503974420,3679013266,168166924,1814307912,3831258296,1573044895,1859376061,4021070915,2791465668,2828112185,2761266481,937747667,2339994098,854058965,1137232011,1496790894,3077402074,2358086913,1691735473,3528347292,3769215305,3027004632,4199962284,133494003,636152527,2942657994,2390391540,3920539207,403179536,3585784431,2289596656,1864705354,1915629148,605822008,4054230615,3350508659,1371981463,602466507,2094914977,2624877800,555687742,3712699286,3703422305,2257292045,2240449039,2423288032,1111375484,3300242801,2858837708,3628615824,84083462,32962295,302911004,2741068226,1597322602,4183250862,3501832553,2441512471,1489093017,656219450,3114180135,954327513,335083755,3013122091,856756514,3144247762,1893325225,2307821063,2811532339,3063651117,572399164,2458355477,552200649,1238290055,4283782570,2015897680,2061492133,2408352771,4171342169,2156497161,386731290,3669999461,837215959,3326231172,3093850320,3275833730,2962856233,1999449434,286199582,3417354363,4233385128,3602627437,974525996],T2=[1667483301,2088564868,2004348569,2071721613,4076011277,1802229437,1869602481,3318059348,808476752,16843267,1734856361,724260477,4278118169,3621238114,2880130534,1987505306,3402272581,2189565853,3385428288,2105408135,4210749205,1499050731,1195871945,4042324747,2913812972,3570709351,2728550397,2947499498,2627478463,2762232823,1920132246,3233848155,3082253762,4261273884,2475900334,640044138,909536346,1061125697,4160222466,3435955023,875849820,2779075060,3857043764,4059166984,1903288979,3638078323,825320019,353708607,67373068,3351745874,589514341,3284376926,404238376,2526427041,84216335,2593796021,117902857,303178806,2155879323,3806519101,3958099238,656887401,2998042573,1970662047,151589403,2206408094,741103732,437924910,454768173,1852759218,1515893998,2694863867,1381147894,993752653,3604395873,3014884814,690573947,3823361342,791633521,2223248279,1397991157,3520182632,0,3991781676,538984544,4244431647,2981198280,1532737261,1785386174,3419114822,3200149465,960066123,1246401758,1280088276,1482207464,3486483786,3503340395,4025468202,2863288293,4227591446,1128498885,1296931543,859006549,2240090516,1162185423,4193904912,33686534,2139094657,1347461360,1010595908,2678007226,2829601763,1364304627,2745392638,1077969088,2408514954,2459058093,2644320700,943222856,4126535940,3166462943,3065411521,3671764853,555827811,269492272,4294960410,4092853518,3537026925,3452797260,202119188,320022069,3974939439,1600110305,2543269282,1145342156,387395129,3301217111,2812761586,2122251394,1027439175,1684326572,1566423783,421081643,1936975509,1616953504,2172721560,1330618065,3705447295,572671078,707417214,2425371563,2290617219,1179028682,4008625961,3099093971,336865340,3739133817,1583267042,185275933,3688607094,3772832571,842163286,976909390,168432670,1229558491,101059594,606357612,1549580516,3267534685,3553869166,2896970735,1650640038,2442213800,2509582756,3840201527,2038035083,3890730290,3368586051,926379609,1835915959,2374828428,3587551588,1313774802,2846444e3,1819072692,1448520954,4109693703,3941256997,1701169839,2054878350,2930657257,134746136,3132780501,2021191816,623200879,774790258,471611428,2795919345,3031724999,3334903633,3907570467,3722289532,1953818780,522141217,1263245021,3183305180,2341145990,2324303749,1886445712,1044282434,3048567236,1718013098,1212715224,50529797,4143380225,235805714,1633796771,892693087,1465364217,3115936208,2256934801,3250690392,488454695,2661164985,3789674808,4177062675,2560109491,286335539,1768542907,3654920560,2391672713,2492740519,2610638262,505297954,2273777042,3924412704,3469641545,1431677695,673730680,3755976058,2357986191,2711706104,2307459456,218962455,3216991706,3873888049,1111655622,1751699640,1094812355,2576951728,757946999,252648977,2964356043,1414834428,3149622742,370551866],T3=[1673962851,2096661628,2012125559,2079755643,4076801522,1809235307,1876865391,3314635973,811618352,16909057,1741597031,727088427,4276558334,3618988759,2874009259,1995217526,3398387146,2183110018,3381215433,2113570685,4209972730,1504897881,1200539975,4042984432,2906778797,3568527316,2724199842,2940594863,2619588508,2756966308,1927583346,3231407040,3077948087,4259388669,2470293139,642542118,913070646,1065238847,4160029431,3431157708,879254580,2773611685,3855693029,4059629809,1910674289,3635114968,828527409,355090197,67636228,3348452039,591815971,3281870531,405809176,2520228246,84545285,2586817946,118360327,304363026,2149292928,3806281186,3956090603,659450151,2994720178,1978310517,152181513,2199756419,743994412,439627290,456535323,1859957358,1521806938,2690382752,1386542674,997608763,3602342358,3011366579,693271337,3822927587,794718511,2215876484,1403450707,3518589137,0,3988860141,541089824,4242743292,2977548465,1538714971,1792327274,3415033547,3194476990,963791673,1251270218,1285084236,1487988824,3481619151,3501943760,4022676207,2857362858,4226619131,1132905795,1301993293,862344499,2232521861,1166724933,4192801017,33818114,2147385727,1352724560,1014514748,2670049951,2823545768,1369633617,2740846243,1082179648,2399505039,2453646738,2636233885,946882616,4126213365,3160661948,3061301686,3668932058,557998881,270544912,4293204735,4093447923,3535760850,3447803085,202904588,321271059,3972214764,1606345055,2536874647,1149815876,388905239,3297990596,2807427751,2130477694,1031423805,1690872932,1572530013,422718233,1944491379,1623236704,2165938305,1335808335,3701702620,574907938,710180394,2419829648,2282455944,1183631942,4006029806,3094074296,338181140,3735517662,1589437022,185998603,3685578459,3772464096,845436466,980700730,169090570,1234361161,101452294,608726052,1555620956,3265224130,3552407251,2890133420,1657054818,2436475025,2503058581,3839047652,2045938553,3889509095,3364570056,929978679,1843050349,2365688973,3585172693,1318900302,2840191145,1826141292,1454176854,4109567988,3939444202,1707781989,2062847610,2923948462,135272456,3127891386,2029029496,625635109,777810478,473441308,2790781350,3027486644,3331805638,3905627112,3718347997,1961401460,524165407,1268178251,3177307325,2332919435,2316273034,1893765232,1048330814,3044132021,1724688998,1217452104,50726147,4143383030,236720654,1640145761,896163637,1471084887,3110719673,2249691526,3248052417,490350365,2653403550,3789109473,4176155640,2553000856,287453969,1775418217,3651760345,2382858638,2486413204,2603464347,507257374,2266337927,3922272489,3464972750,1437269845,676362280,3752164063,2349043596,2707028129,2299101321,219813645,3211123391,3872862694,1115997762,1758509160,1099088705,2569646233,760903469,253628687,2960903088,1420360788,3144537787,371997206],T4=[3332727651,4169432188,4003034999,4136467323,4279104242,3602738027,3736170351,2438251973,1615867952,33751297,3467208551,1451043627,3877240574,3043153879,1306962859,3969545846,2403715786,530416258,2302724553,4203183485,4011195130,3001768281,2395555655,4211863792,1106029997,3009926356,1610457762,1173008303,599760028,1408738468,3835064946,2606481600,1975695287,3776773629,1034851219,1282024998,1817851446,2118205247,4110612471,2203045068,1750873140,1374987685,3509904869,4178113009,3801313649,2876496088,1649619249,708777237,135005188,2505230279,1181033251,2640233411,807933976,933336726,168756485,800430746,235472647,607523346,463175808,3745374946,3441880043,1315514151,2144187058,3936318837,303761673,496927619,1484008492,875436570,908925723,3702681198,3035519578,1543217312,2767606354,1984772923,3076642518,2110698419,1383803177,3711886307,1584475951,328696964,2801095507,3110654417,0,3240947181,1080041504,3810524412,2043195825,3069008731,3569248874,2370227147,1742323390,1917532473,2497595978,2564049996,2968016984,2236272591,3144405200,3307925487,1340451498,3977706491,2261074755,2597801293,1716859699,294946181,2328839493,3910203897,67502594,4269899647,2700103760,2017737788,632987551,1273211048,2733855057,1576969123,2160083008,92966799,1068339858,566009245,1883781176,4043634165,1675607228,2009183926,2943736538,1113792801,540020752,3843751935,4245615603,3211645650,2169294285,403966988,641012499,3274697964,3202441055,899848087,2295088196,775493399,2472002756,1441965991,4236410494,2051489085,3366741092,3135724893,841685273,3868554099,3231735904,429425025,2664517455,2743065820,1147544098,1417554474,1001099408,193169544,2362066502,3341414126,1809037496,675025940,2809781982,3168951902,371002123,2910247899,3678134496,1683370546,1951283770,337512970,2463844681,201983494,1215046692,3101973596,2673722050,3178157011,1139780780,3299238498,967348625,832869781,3543655652,4069226873,3576883175,2336475336,1851340599,3669454189,25988493,2976175573,2631028302,1239460265,3635702892,2902087254,4077384948,3475368682,3400492389,4102978170,1206496942,270010376,1876277946,4035475576,1248797989,1550986798,941890588,1475454630,1942467764,2538718918,3408128232,2709315037,3902567540,1042358047,2531085131,1641856445,226921355,260409994,3767562352,2084716094,1908716981,3433719398,2430093384,100991747,4144101110,470945294,3265487201,1784624437,2935576407,1775286713,395413126,2572730817,975641885,666476190,3644383713,3943954680,733190296,573772049,3535497577,2842745305,126455438,866620564,766942107,1008868894,361924487,3374377449,2269761230,2868860245,1350051880,2776293343,59739276,1509466529,159418761,437718285,1708834751,3610371814,2227585602,3501746280,2193834305,699439513,1517759789,504434447,2076946608,2835108948,1842789307,742004246],maxkc=8,maxrk=14;/* OpenPGP radix-64/base64 string encoding/decoding
 * Copyright 2005 Herbert Hanewinkel, www.haneWIN.de
 * version 1.0, check www.haneWIN.de for the latest version

 * This software is provided as-is, without express or implied warranty.  
 * Permission to use, copy, modify, distribute or sell this software, with or
 * without fee, for any purpose and by any individual or organization, is hereby
 * granted, provided that the above copyright notice and this paragraph appear 
 * in all copies. Distribution as a part of an application or binary must
 * include the above copyright notice in the documentation and/or other materials
 * provided with the application or distribution.
 */"use strict";function s2r(e){var t,n,r,i="",s=0,o=0,u=e.length;for(r=0;r<u;r++)n=e.charCodeAt(r),o==0?(i+=b64s.charAt(n>>2&63),t=(n&3)<<4):o==1?(i+=b64s.charAt(t|n>>4&15),t=(n&15)<<2):o==2&&(i+=b64s.charAt(t|n>>6&3),s+=1,s%60==0&&(i+="\n"),i+=b64s.charAt(n&63)),s+=1,s%60==0&&(i+="\n"),o+=1,o==3&&(o=0);return o>0&&(i+=b64s.charAt(t),s+=1,s%60==0&&(i+="\n"),i+="=",s+=1),o==1&&(s%60==0&&(i+="\n"),i+="="),i}function r2s(e){var t,n,r="",i=0,s=0,o=e.length;for(n=0;n<o;n++)t=b64s.indexOf(e.charAt(n)),t>=0&&(i&&(r+=String.fromCharCode(s|t>>6-i&255)),i=i+2&7,s=t<<i&255);return r}var b64s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";/* Collect entropy from mouse motion and key press events
 * Note that this is coded to work with either DOM2 or Internet Explorer
 * style events.
 * We don't use every successive mouse movement event.
 * Instead, we use some bits from random() to determine how many
 * subsequent mouse movements we ignore before capturing the next one.
 * rc4 is used as a mixing function for the captured mouse events.  
 *
 * mouse motion event code originally from John Walker
 * key press timing code thanks to Nigel Johnstone
 */"use strict";function rc4Init(){var e,t,n=new Array(256);for(e=0;e<256;e++)s[e]=e,n[e]=randomByte()^timeByte();y=0;for(e=0;e<2;e++)for(x=0;x<256;x++)y=(n[e]+s[x]+y)%256,t=s[x],s[x]=s[y],s[y]=t;x=0,y=0}function rc4Next(e){var t,n;return x=x+1&255,y=s[x]+y&255,t=s[x],s[x]=s[y],s[y]=t,(e^s[(s[x]+s[y])%256])&255}function keyByte(){return keyArray[keyRead++%keyNext]}function keyPressEntropy(e){keyArray[keyNext++%256]^=timeByte()}function mouseByte(){return mouseArray[mouseRead++%mouseNext]}function mouseMoveEntropy(e){var t;e||(e=window.event),mouseMoveSkip--<=0&&(oldMoveHandler?t=e.clientX<<4|e.clientY&15:t=e.screenX<<4|e.screenY&15,mouseArray[mouseNext++%256]^=rc4Next(t&255),mouseArray[mouseNext++%256]^=rc4Next(timeByte()),mouseMoveSkip=randomByte()&7)}function eventsEnd(){document.removeEventListener?(document.removeEventListener("mousemove",mouseMoveEntropy,!1),document.removeEventListener("keypress",keyPressEntropy,!1)):document.detachEvent?(document.detachEvent("onmousemove",mouseMoveEntropy),document.detachEvent("onkeypress",keyPressEntropy)):document.releaseEvents?(document.releaseEvents(EVENT.MOUSEMOVE),document.onMousemove=0,document.releaseEvents(EVENT.KEYPRESS),document.onKeypress=0):(document.onMousemove=oldMoveHandler,document.onKeypress=oldKeyHandler)}function eventsCollect(){document.implementation.hasFeature("Events","2.0")&&document.addEventListener?(document.addEventListener("mousemove",mouseMoveEntropy,!1),document.addEventListener("keypress",keyPressEntropy,!1)):document.attachEvent?(document.attachEvent("onmousemove",mouseMoveEntropy),document.attachEvent("onkeypress",keyPressEntropy)):document.captureEvents?(document.captureEvents(Event.MOUSEMOVE),document.onMousemove=mouseMoveEntropy,document.captureEvents(Event.KEYPRESS),document.onMousemove=keyPressEntropy):(oldMoveHandler=document.onmousemove,document.onMousemove=mouseMoveEntropy,oldKeyHandler=document.onkeypress,document.onKeypress=keyPressEntropy),rc4Init()}var oldKeyHandler,keyRead=0,keyNext=0,keyArray=new Array(256),mouseMoveSkip=0,oldMoveHandler,mouseRead=0,mouseNext=0,mouseArray=new Array(256),s=new Array(256),x,y;/* OpenPGP encryption using RSA/AES
 * Copyright 2005-2006 Herbert Hanewinkel, www.haneWIN.de
 * version 2.0, check www.haneWIN.de for the latest version

 * This software is provided as-is, without express or implied warranty.  
 * Permission to use, copy, modify, distribute or sell this software, with or
 * without fee, for any purpose and by any individual or organization, is hereby
 * granted, provided that the above copyright notice and this paragraph appear 
 * in all copies. Distribution as a part of an application or binary must
 * include the above copyright notice in the documentation and/or other
 * materials provided with the application or distribution.
 *//* We need an unpredictable session key of 128 bits ( = 2^128 possible keys).
 * If we generate the session key with a PRNG from a small seed we get only
 * a small number of session keys, e.g. 4 bytes seed => 2^32 keys, a brute
 * force attack could try all 2^32 session keys. 
 * (see RFC 1750 - Randomness Recommendations for Security.)
 *
 * Sources for randomness in Javascript are limited.
 * We have load, exec time, seed from random(), mouse movement events
 * and the timing from key press events.
 * But even here we have restrictions.
 * - A mailer will add a timestamp to the encrypted message, therefore
 *   only the msecs from the clock can be seen as unpredictable.
 * - Because the Windows timer is still based on the old DOS timer,
 *   the msecs jump under Windows in 18.2 msecs steps.
 * - Only a few bits from mouse mouvement event coordinates are unpredictable,
 *   if the same buttons are clicked on the screen.
 */"use strict";function randomByte(){return Math.round(Math.random()*255)&255}function timeByte(){return(new Date).getTime()>>>2&255}function rnTimer(){var e=timeByte();for(var t=0;t<256;t++)e^=randomByte(),rnArray[rnNext++&255]^=e;window.setTimeout("rnTimer()",randomByte()|128)}function randomString(e,t){var n="",r=timeByte();for(var i=0;i<e;){r^=rnArray[rnRead++&255]^mouseByte()^keyByte();if(r==0&&t)continue;i++,n+=String.fromCharCode(r)}return n}function hex2s(e){var t="";e.length%2&&(e+="0");for(var n=0;n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.slice(n,n+2),16));return t}function crc24(e){var t=11994318;for(var n=0;n<e.length;n++){t^=(e.charCodeAt(n)&255)<<16;for(var r=0;r<8;r++)t<<=1,t&16777216&&(t^=25578747)}return String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)}function GPGencrypt(e,t){var n,r,i=t.length,s=e.length,o=new Array(bpbl),u=new Array(bpbl),a=new Array(bpbl+2),f=new Array,l="";if(i%bpbl)for(n=i%bpbl;n<bpbl;n++)t+="\0";f=keyExpansion(e);for(n=0;n<bpbl;n++)o[n]=0,u[n]=randomByte();o=AESencrypt(o,f);for(n=0;n<bpbl;n++)a[n]=o[n]^=u[n];o=AESencrypt(o,f),a[bpbl]=o[0]^u[bpbl-2],a[bpbl+1]=o[1]^u[bpbl-1];for(n=0;n<bpbl+2;n++)l+=String.fromCharCode(a[n]);o=a.slice(2,bpbl+2);for(r=0;r<t.length;r+=bpbl){o=AESencrypt(o,f);for(n=0;n<bpbl;n++)o[n]^=t.charCodeAt(r+n),l+=String.fromCharCode(o[n])}return l.substr(0,i+bpbl+2)}function GPGpkt(e,t){t>255&&(e+=1);var n=String.fromCharCode(e);return t>255&&(n+=String.fromCharCode(t/256)),n+=String.fromCharCode(t%256),n}function GPGpkesk(e,t,n,r,i){var s=[3,5,9,17,513,2049,4097,8193],o=new Array,u=new Array,a="",f=r2s(i),l=Math.floor((f.charCodeAt(0)*256+f.charCodeAt(1)+7)/8);o=mpi2b(f.substr(0,l+2));if(t){var c=new Array,h=new Array,p=new Array,d=new Array,v=Math.floor((f.charCodeAt(l+2)*256+f.charCodeAt(l+3)+7)/8)+2;c=mpi2b(f.substr(l+2,v)),h=mpi2b(f.substr(l+2+v)),u[0]=9,p=bmodexp(c,u,o),d=bmodexp(h,u,o)}else u=mpi2b(f.substr(l+2));var m=r.length,g=0;for(var y=0;y<m;y++)g+=r.charCodeAt(y);g&=65535;var b=(l-2)*8+2,w=String.fromCharCode(b/256)+String.fromCharCode(b%256)+String.fromCharCode(2)+randomString(l-m-6,1)+"\0"+String.fromCharCode(n)+r+String.fromCharCode(g/256)+String.fromCharCode(g&255);return t?(a=b2mpi(p)+b2mpi(bmod(bmul(mpi2b(w),d),o)),GPGpkt(132,a.length+10)+String.fromCharCode(3)+e+String.fromCharCode(16)+a):(a=b2mpi(bmodexp(mpi2b(w),u,o)),GPGpkt(132,a.length+10)+String.fromCharCode(3)+e+String.fromCharCode(1)+a)}function GPGld(e){return e.indexOf("\r\n")==-1&&(e=e.replace(/\n/g,"\r\n")),GPGpkt(172,e.length+10)+"t"+String.fromCharCode(4)+"file\0\0\0\0"+e}function GPGsed(e,t){var n=GPGencrypt(e,GPGld(t));return GPGpkt(164,n.length)+n}function doEncrypt(e,t,n,r){var i=7,s=[16,24,32],o=s[i-7],u=randomString(o,0);e=hex2s(e);var a=GPGpkesk(e,t,i,u,n)+GPGsed(u,r);return"-----BEGIN PGP MESSAGE-----\nVersion: haneWIN JavascriptPG v2.0\n\n"+s2r(a)+"\n="+s2r(crc24(a))+"\n-----END PGP MESSAGE-----\n"}var rnArray=new Array(256),rnNext=0,rnRead=0;rnTimer(),eventsCollect();var bpbl=16;/* OpenPGP public key extraction
 * Copyright 2005 Herbert Hanewinkel, www.haneWIN.de
 * version 1.1, check www.haneWIN.de for the latest version

 * This software is provided as-is, without express or implied warranty.  
 * Permission to use, copy, modify, distribute or sell this software, with or
 * without fee, for any purpose and by any individual or organization, is hereby
 * granted, provided that the above copyright notice and this paragraph appear 
 * in all copies. Distribution as a part of an application or binary must
 * include the above copyright notice in the documentation and/or other materials
 * provided with the application or distribution.
 */"use strict";function s2hex(e){var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t+=(r<16?"0":"")+r.toString(16)}return t}function getPublicKey(e){var t=0,n=e.indexOf("-----BEGIN PGP PUBLIC KEY BLOCK-----");if(n==-1){alert("No PGP Public Key Block"),this.vers="",this.fp="",this.keyid="",this.user="",this.pkey="";return}var r=e.indexOf("\n\n",n);r>0?r+=2:(r=e.indexOf("\n\r\n",n),r>0&&(r+=3));var i=e.indexOf("\n=",n);if(!(r>0&&i>0)){alert("Invalid PGP Public Key Block"),this.vers="",this.fp="",this.keyid="",this.user="",this.pkey="";return}e=e.slice(r,i);var s=r2s(e);for(var n=0;n<s.length;){var o=s.charCodeAt(n++);if((o&128)==0)break;var u;o&64?(o&=63,u=s.charCodeAt(n++),u>191&&u<224?u=(u-192<<8)+s.charCodeAt(n++):u==255?u=(s.charCodeAt(n++)<<24)+(s.charCodeAt(n++)<<16)+(s.charCodeAt(n++)<<8)+s.charCodeAt(n++):u>223&&u<255&&(u=1<<(u&31))):(u=o&3,o=o>>2&15,u==0?u=s.charCodeAt(n++):u==1?u=(s.charCodeAt(n++)<<8)+s.charCodeAt(n++):u==2?u=(s.charCodeAt(n++)<<24)+(s.charCodeAt(n++)<<16)+(s.charCodeAt(n++)<<8)+s.charCodeAt(n++):u=s.length-1);if(o==6||o==14){var a=n,f=s.charCodeAt(n++);t=1,this.vers=f;var l=(s.charCodeAt(n++)<<24)+(s.charCodeAt(n++)<<16)+(s.charCodeAt(n++)<<8)+s.charCodeAt(n++);if(f==2||f==3)var c=s.charCodeAt(n++)<<8+s.charCodeAt(n++);var h=s.charCodeAt(n++);if(h==1||h==2){var p=n,d=Math.floor((s.charCodeAt(n)*256+s.charCodeAt(n+1)+7)/8);n+=d+2;var v=s.substr(p,d+2),m=Math.floor((s.charCodeAt(n)*256+s.charCodeAt(n+1)+7)/8);n+=m+2,this.pkey=s2r(s.substr(p,d+m+4)),this.type="RSA";if(f==3)this.fp="",this.keyid=s2hex(v.substr(v.length-8,8));else if(f==4){var g=String.fromCharCode(153)+String.fromCharCode(u>>8)+String.fromCharCode(u&255)+s.substr(a,u),y=str_sha1(g);this.fp=s2hex(y),this.keyid=s2hex(y.substr(y.length-8,8))}else this.fp="",this.keyid="";t=2}else if(h!=16&&h!=20||f!=4)n=a+u;else{var p=n,b=Math.floor((s.charCodeAt(n)*256+s.charCodeAt(n+1)+7)/8);n+=b+2;var w=Math.floor((s.charCodeAt(n)*256+s.charCodeAt(n+1)+7)/8);n+=w+2;var E=Math.floor((s.charCodeAt(n)*256+s.charCodeAt(n+1)+7)/8);n+=E+2,this.pkey=s2r(s.substr(p,b+w+E+6));var g=String.fromCharCode(153)+String.fromCharCode(u>>8)+String.fromCharCode(u&255)+s.substr(a,u),y=str_sha1(g);this.fp=s2hex(y),this.keyid=s2hex(y.substr(y.length-8,8)),this.type="ELGAMAL",t=3}}else o==13?(this.user=s.substr(n,u),n+=u):n+=u}t<2&&(this.vers="",this.fp="",this.keyid="",t==0?this.user="No public key packet found.":t==1&&(this.user="public key algorithm is "+h+" not RSA or ELGAMAL."),this.pkey="")};/* RSA public key encryption/decryption
 * The following functions are (c) 2000 by John M Hanna and are
 * released under the terms of the Gnu Public License.
 * You must freely redistribute them with their source -- see the
 * GPL for details.
 *  -- Latest version found at http://sourceforge.net/projects/shop-js
 *
 * Modifications and GnuPG multi precision integer (mpi) conversion added
 * 2004 by Herbert Hanewinkel, www.haneWIN.de
 */"use strict";function zeros(e){var t=new Array(e);while(e-->0)t[e]=0;return t}function zclip(e){var t=e.length;if(e[t-1])return e;while(t>1&&e[t-1]==0)t--;return e.slice(0,t)}function nbits(e){var t=1,n;return(n=e>>>16)!=0&&(e=n,t+=16),(n=e>>8)!=0&&(e=n,t+=8),(n=e>>4)!=0&&(e=n,t+=4),(n=e>>2)!=0&&(e=n,t+=2),(n=e>>1)!=0&&(e=n,t+=1),t}function badd(e,t){var n=e.length,r=t.length;if(n<r)return badd(t,e);var i=new Array(n),s=0,o=0;for(;o<r;o++)s+=e[o]+t[o],i[o]=s&bm,s>>>=bs;for(;o<n;o++)s+=e[o],i[o]=s&bm,s>>>=bs;return s&&(i[o]=s),i}function bsub(e,t){var n=e.length,r=t.length;if(r>n)return[];if(r==n){if(t[r-1]>e[r-1])return[];if(r==1)return[e[0]-t[0]]}var i=new Array(n),s=0;for(var o=0;o<r;o++)s+=e[o]-t[o],i[o]=s&bm,s>>=bs;for(;o<n;o++)s+=e[o],i[o]=s&bm,s>>=bs;return s?[]:zclip(i)}function ip(e,t,n,r,i){var s=n&bdm,o=n>>bd,u=r&bdm,a=r>>bd,f=o*u+a*s,l=s*u+((f&bdm)<<bd)+e[t]+i;return e[t]=l&bm,i=o*a+(f>>bd)+(l>>bs),i}function bsqr(e){var t=e.length,n=2*t,r=zeros(n),i=0,s,o;for(s=0;s<t;s++){i=ip(r,2*s,e[s],e[s],0);for(o=s+1;o<t;o++)i=ip(r,s+o,2*e[o],e[s],i);r[s+t]=i}return zclip(r)}function bmul(e,t){var n=e.length,r=t.length,i=zeros(n+r-1),s,o,u;for(o=0;o<r;o++){s=0;for(u=0;u<n;u++)s=ip(i,o+u,e[u],t[o],s);i[o+n]=s}return zclip(i)}function toppart(e,t,n){var r=0;while(t>=0&&n-->0)r=r*bx2+e[t--];return r}function bdiv(e,t){var n=e.length-1,r=t.length-1,i=n-r,s={};if(n<r||n==r&&(e[n]<t[n]||n>0&&e[n]==t[n]&&e[n-1]<t[n-1]))return s.q=[0],s.mod=e,s;if(n==r&&toppart(e,r,2)/toppart(t,r,2)<4){var o=e.concat(),u=0,a;for(;;){a=bsub(o,t);if(a.length==0)break;o=a,u++}return s.q=[u],s.mod=o,s}var f=Math.floor(Math.log(t[r])/log2)+1,l=bs-f,o=e.concat(),c=t.concat();if(l){for(h=r;h>0;h--)c[h]=c[h]<<l&bm|c[h-1]>>f;c[0]=c[0]<<l&bm,o[n]&(bm<<f&bm)&&(o[++n]=0,i++);for(h=n;h>0;h--)o[h]=o[h]<<l&bm|o[h-1]>>f;o[0]=o[0]<<l&bm}var h,p,d,v=zeros(i+1),m=zeros(i).concat(c);for(;;){d=bsub(o,m);if(d.length==0)break;v[i]++,o=d}var g=c[r],y=toppart(c,r,2);for(h=n;h>r;h--){var b=h-r-1;h>=o.length?v[b]=1:o[h]==g?v[b]=bm:v[b]=Math.floor(toppart(o,h,2)/g);var w=toppart(o,h,3);while(v[b]*y>w)v[b]--;m=m.slice(1),d=bsub(o,bmul([v[b]],m)),d.length==0&&(v[b]--,d=bsub(o,bmul([v[b]],m))),o=d}if(l){for(h=0;h<o.length-1;h++)o[h]=o[h]>>l|o[h+1]<<f&bm;o[o.length-1]>>=l}return s.q=zclip(v),s.mod=zclip(o),s}function simplemod(e,t){var n=0,r;for(var i=e.length-1;i>=0;i--)r=e[i],n=((r>>bd)+(n<<bd))%t,n=((r&bdm)+(n<<bd))%t;return n}function bmod(e,t){if(t.length==1){if(e.length==1)return[e[0]%t[0]];if(t[0]<bdm)return[simplemod(e,t[0])]}var n=bdiv(e,t);return n.mod}function bmod2(e,t,n){var r=e.length-(t.length<<1);if(r>0)return bmod2(e.slice(0,r).concat(bmod2(e.slice(r),t,n)),t,n);var i=t.length+1,s=t.length-1,o,u=bmul(e.slice(s),n).slice(i),a=e.slice(0,i),f=bmul(u,t).slice(0,i),l=bsub(a,f);l.length==0&&(a[i]=1,l=bsub(a,f));for(var c=0;;c++){o=bsub(l,t);if(o.length==0)break;l=o;if(c>=3)return bmod2(l,t,n)}return l}function bexpmod(e,t,n){var r=e.concat(),i=t.length-1,s=nbits(t[i])-2;for(;i>=0;i--){for(;s>=0;s-=1)r=bmod(bsqr(r),n),t[i]&1<<s&&(r=bmod(bmul(r,e),n));s=bs-1}return r}function bmodexp(e,t,n){var r=e.concat(),i=t.length-1,s=n.length*2,o=zeros(s+1);o[s]=1,o=bdiv(o,n).q,s=nbits(t[i])-2;for(;i>=0;i--){for(;s>=0;s-=1)r=bmod2(bsqr(r),n,o),t[i]&1<<s&&(r=bmod2(bmul(r,e),n,o));s=bs-1}return r}function RSAencrypt(e,t,n){return bexpmod(e,t,n)}function RSAdecrypt(e,t,n,r,i){var s=bmodexp(bmod(e,n),bmod(t,bsub(n,[1])),n),o=bmodexp(bmod(e,r),bmod(t,bsub(r,[1])),r),u=bsub(o,s);return u.length==0?(u=bsub(s,o),u=bmod(bmul(u,i),r),u=bsub(r,u)):u=bmod(bmul(u,i),r),badd(bmul(u,n),s)}function mpi2b(e){var t=1,n=[0],r=0,i=256,s,o=e.length;if(o<2)return alert("string too short, not a MPI"),0;var u=(o-2)*8,a=e.charCodeAt(0)*256+e.charCodeAt(1);if(a>u||a<u-8)return alert("not a MPI, bits="+a+",len="+u),0;for(var f=0;f<u;f++)(i<<=1)>255&&(i=1,s=e.charCodeAt(--o)),t>bm&&(t=1,n[++r]=0),s&i&&(n[r]|=t),t<<=1;return n}function b2mpi(e){var t=1,n=0,r=[0],i=1,s=0,o=e.length*bs,u,a="";for(u=0;u<o;u++)e[n]&t&&(r[s]|=i),(i<<=1)>255&&(i=1,r[++s]=0),(t<<=1)>bm&&(t=1,n++);while(s&&r[s]==0)s--;t=256;for(o=8;o>0;o--)if(r[s]&(t>>=1))break;o+=s*8,a+=String.fromCharCode(o/256)+String.fromCharCode(o%256);if(o)for(u=s;u>=0;u--)a+=String.fromCharCode(r[u]);return a}var bs=28,bx2=1<<bs,bm=bx2-1,bx=bx2>>1,bd=bs>>1,bdm=(1<<bd)-1,log2=Math.log(2);/*
 * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined
 * in FIPS PUB 180-1
 * Version 2.1 Copyright Paul Johnston 2000 - 2002.
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for details.
 */"use strict";function hex_sha1(e){return binb2hex(core_sha1(str2binb(e),e.length*chrsz))}function b64_sha1(e){return binb2b64(core_sha1(str2binb(e),e.length*chrsz))}function str_sha1(e){return binb2str(core_sha1(str2binb(e),e.length*chrsz))}function hex_hmac_sha1(e,t){return binb2hex(core_hmac_sha1(e,t))}function b64_hmac_sha1(e,t){return binb2b64(core_hmac_sha1(e,t))}function str_hmac_sha1(e,t){return binb2str(core_hmac_sha1(e,t))}function sha1_vm_test(){return hex_sha1("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function core_sha1(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;var n=Array(80),r=1732584193,i=-271733879,s=-1732584194,o=271733878,u=-1009589776;for(var a=0;a<e.length;a+=16){var f=r,l=i,c=s,h=o,p=u;for(var d=0;d<80;d++){d<16?n[d]=e[a+d]:n[d]=rol(n[d-3]^n[d-8]^n[d-14]^n[d-16],1);var v=safe_add(safe_add(rol(r,5),sha1_ft(d,i,s,o)),safe_add(safe_add(u,n[d]),sha1_kt(d)));u=o,o=s,s=rol(i,30),i=r,r=v}r=safe_add(r,f),i=safe_add(i,l),s=safe_add(s,c),o=safe_add(o,h),u=safe_add(u,p)}return Array(r,i,s,o,u)}function sha1_ft(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function sha1_kt(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function core_hmac_sha1(e,t){var n=str2binb(e);n.length>16&&(n=core_sha1(n,e.length*chrsz));var r=Array(16),i=Array(16);for(var s=0;s<16;s++)r[s]=n[s]^909522486,i[s]=n[s]^1549556828;var o=core_sha1(r.concat(str2binb(t)),512+t.length*chrsz);return core_sha1(i.concat(o),672)}function safe_add(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function rol(e,t){return e<<t|e>>>32-t}function str2binb(e){var t=Array(),n=(1<<chrsz)-1;for(var r=0;r<e.length*chrsz;r+=chrsz)t[r>>5]|=(e.charCodeAt(r/chrsz)&n)<<24-r%32;return t}function binb2str(e){var t="",n=(1<<chrsz)-1;for(var r=0;r<e.length*32;r+=chrsz)t+=String.fromCharCode(e[r>>5]>>>24-r%32&n);return t}function binb2hex(e){var t=hexcase?"0123456789ABCDEF":"0123456789abcdef",n="";for(var r=0;r<e.length*4;r++)n+=t.charAt(e[r>>2]>>(3-r%4)*8+4&15)+t.charAt(e[r>>2]>>(3-r%4)*8&15);return n}function binb2b64(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="";for(var r=0;r<e.length*4;r+=3){var i=(e[r>>2]>>8*(3-r%4)&255)<<16|(e[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|e[r+2>>2]>>8*(3-(r+2)%4)&255;for(var s=0;s<4;s++)r*8+s*6>e.length*32?n+=b64pad:n+=t.charAt(i>>6*(3-s)&63)}return n}var hexcase=0,b64pad="",chrsz=8;